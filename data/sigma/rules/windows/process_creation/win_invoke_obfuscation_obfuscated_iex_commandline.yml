filter: 'process.command_line|re: "\$PSHome\[\s*\d{1,3}\s*\]\s*\+\s*\$PSHome\[" OR
  process.command_line|re: "\$ShellId\[\s*\d{1,3}\s*\]\s*\+\s*\$ShellId\[" OR process.command_line|re:
  "\$env:Public\[\s*\d{1,3}\s*\]\s*\+\s*\$env:Public\[" OR process.command_line|re:
  "\$env:ComSpec\[(\s*\d{1,3}\s*,){2}" OR process.command_line|re: "\*mdr\*\W\s*\)\.Name"
  OR process.command_line|re: "\$VerbosePreference\.ToString\(" OR process.command_line|re:
  "\String\]\s*\$VerbosePreference"'
pre_detector:
  case_condition: directly
  id: 4bf943c6-5146-4273-98dd-e958fd1e3abf
  mitre:
  - attack.defense_evasion
  - attack.t1027
  - attack.execution
  - attack.t1059.001
  - attack.t1086
  severity: high
  title: Invoke-Obfuscation Obfuscated IEX Invocation
sigma_fields: true
description: "Detects all variations of obfuscated powershell IEX invocation code
  generated by Invoke-Obfuscation framework from the following code block \u2014 https://github.com/danielbohannon/Invoke-Obfuscation/blob/master/Out-ObfuscatedStringCommand.ps1#L873-L888"
